<?php

// if not included correctly...
if ( !class_exists( 'WpSecurityAuditLog' ) ) exit();

WpSecurityAuditLog::GetInstance()
	->constants->UseConstants(array(
		array('name' => 'E_ERROR', 'description' => 'Fatal run-time error.'),
		array('name' => 'E_WARNING', 'description' => 'Run-time warning (non-fatal error).'),
		array('name' => 'E_PARSE', 'description' => 'Compile-time parse error.'),
		array('name' => 'E_NOTICE', 'description' => 'Run-time notice.'),
		array('name' => 'E_CORE_ERROR', 'description' => 'Fatal error that occurred during startup.'),
		array('name' => 'E_CORE_WARNING', 'description' => 'Warnings that occurred during startup.'),
		array('name' => 'E_COMPILE_ERROR', 'description' => 'Fatal compile-time error.'),
		array('name' => 'E_COMPILE_WARNING', 'description' => 'Compile-time warning.'),
		array('name' => 'E_USER_ERROR', 'description' => 'User-generated error message.'),
		array('name' => 'E_USER_WARNING', 'description' => 'User-generated warning message.'),
		array('name' => 'E_USER_NOTICE', 'description' => 'User-generated notice message. '),
		array('name' => 'E_STRICT', 'description' => 'Non-standard/optimal code warning.'),
		array('name' => 'E_RECOVERABLE_ERROR', 'description' => 'Catchable fatal error.'),
		array('name' => 'E_DEPRECATED', 'description' => 'Run-time deprecation notices.'),
		array('name' => 'E_USER_DEPRECATED', 'description' => 'Run-time user deprecation notices.'),
	));

WpSecurityAuditLog::GetInstance()
	->alerts->RegisterGroup(array(
		'Other User Activity' => array(
			array(1000, E_NOTICE, 'User logs in', 'Successfully logged in'),
			array(1001, E_NOTICE, 'User logs out', 'Successfully logged out'),
			array(1002, E_WARNING, 'Login failed', 'Failed login detected using "%Username%" as username'),
			array(2010, E_NOTICE, 'User uploaded file from Uploads directory', 'Uploaded the file %FileName% in %FilePath%'),
			array(2011, E_WARNING, 'User deleted file from Uploads directory', 'Deleted the file %FileName% from %FilePath%'),
			array(2046, E_ERROR, 'User changed a file using the editor', ''),
		),
		'Blog Posts' => array(
			array(2000, E_NOTICE, 'User created a new blog post and saved it as draft', ''),
			array(2001, E_NOTICE, 'User published a blog post', ''),
			array(2002, E_NOTICE, 'User modified a published blog post', ''),
			array(2003, E_NOTICE, 'User modified a draft blog post', ''),
			array(2008, E_NOTICE, 'User permanently deleted a blog post from the trash', ''),
			array(2012, E_WARNING, 'User moved a blog post to the trash', ''),
			array(2014, E_ERROR, 'User restored a blog post from trash', ''),
			array(2016, E_NOTICE, 'User changed blog post category', ''),
			array(2017, E_NOTICE, 'User changed blog post URL', ''),
			array(2019, E_NOTICE, 'User changed blog post author', 'Changed the author of %PostTitle% post from %OldAuthor% to %NewAuthor%'),
			array(2021, E_NOTICE, 'User changed blog post status', ''),
			array(2023, E_NOTICE, 'User created new category', ''),
			array(2024, E_WARNING, 'User deleted category', ''),
			array(2025, E_WARNING, 'User changed the visibility of a blog post', ''),
			array(2027, E_NOTICE, 'User changed the date of a blog post', 'Changed the date of %PostTitle% blog post from %OldDate% to %NewDate%'),
			array(2050, E_NOTICE, 'User removes post from sticky', ''),
			array(2049, E_ERROR, 'User sets a post as sticky', ''),
		),
		'Pages' => array(
			array(2004, E_NOTICE, 'User created a new WordPress page and saved it as draft', ''),
			array(2005, E_NOTICE, 'User published a WorPress page', ''),
			array(2006, E_NOTICE, 'User modified a published WordPress page', ''),
			array(2007, E_NOTICE, 'User modified a draft WordPress page', ''),
			array(2009, E_NOTICE, 'User permanently deleted a page from the trash', ''),
			array(2013, E_WARNING, 'User moved WordPress page to the trash', ''),
			array(2015, E_ERROR, 'User restored a WordPress page from trash', ''),
			array(2018, E_NOTICE, 'User changed page URL', ''),
			array(2020, E_NOTICE, 'User changed page author', 'Changed the author of %PostTitle% page from %OldAuthor% to %NewAuthor%'),
			array(2022, E_NOTICE, 'User changed page status', ''),
			array(2026, E_WARNING, 'User changed the visibility of a page post', ''),
			array(2028, E_NOTICE, 'User changed the date of a page post', 'Changed the date of %PostTitle% page from %OldDate% to %NewDate%'),
			array(2047, E_NOTICE, 'User changed the parent of a page', ''),
			array(2048, E_ERROR, 'User changes the template of a page', ''),
		),
		'Custom Posts' => array(
			array(2029, E_NOTICE, 'User created a new post with custom post type and saved it as draft', ''),
			array(2030, E_NOTICE, 'User published a post with custom post type', ''),
			array(2031, E_NOTICE, 'User modified a post with custom post type', ''),
			array(2032, E_NOTICE, 'User modified a draft post with custom post type', ''),
			array(2033, E_WARNING, 'User permanently deleted post with custom post type', ''),
			array(2034, E_WARNING, 'User moved post with custom post type to trash', ''),
			array(2035, E_ERROR, 'User restored post with custom post type from trash', ''),
			array(2036, E_NOTICE, 'User changed the category of a post with custom post type', ''),
			array(2037, E_NOTICE, 'User changed the URL of a post with custom post type', ''),
			array(2038, E_NOTICE, 'User changed the author or post with custom post type', 'Changed the author of custom post %PostTitle% of type %PostType% from %OldAuthor% to %NewAuthor%'),
			array(2039, E_NOTICE, 'User changed the status of post with custom post type', ''),
			array(2040, E_WARNING, 'User changed the visibility of a post with custom post type', ''),
			array(2041, E_NOTICE, 'User changed the date of post with custom post type', 'Changed the date of custom post %PostTitle% of type %PostType% from %OldDate% to %NewDate%'),
		),
		'Widgets' => array(
			array(2042, E_ERROR, 'User added a new widget', 'Added a new %WidgetName% widget in  %Sidebar%'),
			array(2043, E_WARNING, 'User modified a widget', 'Modified the %WidgetName% widget in %Sidebar%'),
			array(2044, E_ERROR, 'User deleted widget', 'Deleted the %WidgetName% widget from %Sidebar%'),
			array(2045, E_NOTICE, 'User moved widget', 'Moved the %WidgetName% widget from %OldSidebar% to %NewSidebar%'),
		),
		'User Profiles' => array(
			array(4000, E_ERROR, 'A new user was created on WordPress', ''),
			array(4001, E_ERROR, 'A user created another WordPress user', ''),
			array(4002, E_ERROR, 'The role of a user was changed by another WordPress user', ''),
			array(4003, E_ERROR, 'User has changed his or her password', ''),
			array(4004, E_ERROR, 'A user changed another user\'s password', ''),
			array(4005, E_NOTICE, 'User changed his or her email address', ''),
			array(4006, E_NOTICE, 'A user changed another user\'s email address', ''),
			array(4007, E_ERROR, 'A user was deleted by another user', ''),
		),
		'Plugins & Themes' => array(
			array(5000, E_ERROR, 'User installed a plugin', 'Installed the plugin %PluginName% in %PluginPath%'),
			array(5001, E_ERROR, 'User activated a WordPress plugin', 'Activated the plugin %PluginData->Name% installed in %PluginFile%'),
			array(5002, E_ERROR, 'User deactivated a WordPress plugin', 'Deactivated the plugin %PluginData->Name% installed in %PluginFile%'),
			array(5003, E_ERROR, 'User uninstalled a plugin', ''),
			array(5004, E_WARNING, 'User upgraded a plugin', 'Upgrade the plugin %PluginData->Name% installed in %PluginFile%'),
			array(5005, E_ERROR, 'User installed a theme', ''),
			array(5006, E_ERROR, 'User activated a theme', 'Activated theme "%NewTheme->Name%", installed in %NewTheme->get_template_directory%'),
		),
		'System Activity' => array(
			array(0001, E_ERROR, 'PHP error', '%Message%'),
			array(0002, E_WARNING, 'PHP warning', '%Message%'),
			array(0003, E_NOTICE, 'PHP notice', '%Message%'),
			array(0004, E_ERROR, 'PHP exception', '%Message%'),
			array(6000, E_NOTICE, 'Events automatically pruned by system', ''),
			array(6001, E_ERROR, 'Option Anyone Can Register in WordPress settings changed', '%NewValue% the option "Anyone can register"'),
			array(6002, E_ERROR, 'New User Default Role changed', 'Changed the New User Default Role from %OldRole% to %NewRole%'),
			array(6003, E_ERROR, 'WordPress Administrator Notification email changed', 'Changed the WordPress administrator notifications email address from %OldEmail% to %NewEmail%'),
			array(6004, E_ERROR, 'WordPress was updated', ''),
			array(6005, E_ERROR, 'User changes the WordPress Permalinks', ''),
		),
		'MultiSite' => array(
			array(4008, E_ERROR, 'User granted Super Admin privileges', ''),
			array(4009, E_ERROR, 'User revoked from Super Admin privileges', ''),
			array(4010, E_ERROR, 'Existing user added to a site', ''),
			array(4011, E_ERROR, 'User removed from site', ''),
			array(4012, E_ERROR, 'New network user created', ''),
			array(7000, E_ERROR, 'New site added on network', 'Added site %SiteName% to the network'),
			array(7001, E_ERROR, 'Existing site archived', 'Archived site %SiteName%'),
			array(7002, E_ERROR, 'Archived site has been unarchived', 'Unarchived site %SiteName%'),
			array(7003, E_ERROR, 'Deactivated site has been activated', 'Activated site %SiteName%'),
			array(7004, E_ERROR, 'Site has been deactivated', 'Deactivated site %SiteName%'),
			array(7005, E_ERROR, 'Existing site deleted from network', 'Deleted site %SiteName%'),
		),
	));
